{"version":3,"file":"604.53f6634d73ea0e68.js","mappings":"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","names":["setWebhooksMutation","gql","getWebhooksQuery","getAvailableWebhookEventsQuery","getAvailableWebhookRequestTransformersQuery","i0","transformers_r1","name","event_r2","webhook_r4","_r3","item","ctx_r4","deleteWeebhook","id","duplicate","requestTransformer","url","event","WebhookComponent","constructor","formBuilder","dataService","changeDetector","notificationService","this","webhooks","currentPage","itemsPerPage","showMessage","availableWeebhookEvents","filteredWeebhookEvents","avaiabelWebhookRequestTransformers","ngOnInit","query","single$","subscribe","e","availableWebhookEvents","s","toPromise","then","d","availableWebhookRequestTransformers","setPageNumber","setItemsPerPage","showCreateModal","eventName","requestTransformerName","detectChanges","create","mutate","map","w","transformerName","success","setWebhooks","error","filter","requestTransformerSelected","setRequestTransformerName","find","v","supportedEvents","static","t","i1","i2","core","VBU","selectors","decls","vars","consts","template","rf","ctx","$event","WebhookComponent_option_21_Template","WebhookComponent_option_28_Template","WebhookComponent_ng_template_46_Template","undefined","length","WebhookModule","$C","G2t","addNavMenuItem","label","routerLink","icon","imports","SharedModule","RouterModule","forChild","path","pathMatch","component","data","breadcrumb"],"ignoreList":[],"sourceRoot":"webpack:///","sources":["./src/extensions/4e10acefce93d94245fb431d35f587f472fc9481c36fef770b3dc1d0e5b30fe0/queries.ts","./src/extensions/4e10acefce93d94245fb431d35f587f472fc9481c36fef770b3dc1d0e5b30fe0/webhook.component.html","./src/extensions/4e10acefce93d94245fb431d35f587f472fc9481c36fef770b3dc1d0e5b30fe0/webhook.component.ts","./src/extensions/4e10acefce93d94245fb431d35f587f472fc9481c36fef770b3dc1d0e5b30fe0/webhook.module.ts"],"sourcesContent":["import gql from 'graphql-tag';\n\nexport const setWebhooksMutation = gql`\n  mutation setWebhooks($webhooks: [WebhookInput!]!) {\n    setWebhooks(webhooks: $webhooks) {\n      id\n      event\n      requestTransformer {\n        name\n        supportedEvents\n      }\n      url\n    }\n  }\n`;\n\nexport const getWebhooksQuery = gql`\n  query webhooks {\n    webhooks {\n      id\n      event\n      requestTransformer {\n        name\n        supportedEvents\n      }\n      url\n    }\n  }\n`;\n\nexport const getAvailableWebhookEventsQuery = gql`\n  query availableWebhookEvents {\n    availableWebhookEvents\n  }\n`;\n\nexport const getAvailableWebhookRequestTransformersQuery = gql`\n  query availableWebhookRequestTransformers {\n    availableWebhookRequestTransformers {\n      name\n      supportedEvents\n    }\n  }\n`;\n","<vdr-page-block>\n  <vdr-action-bar>\n    <vdr-ab-right>\n      <vdr-action-bar-items locationId=\"collection-list\"></vdr-action-bar-items>\n      <button class=\"btn btn-primary\" (click)=\"showCreateModal()\">\n        <clr-icon shape=\"add\"></clr-icon>\n        Add Webhook\n      </button>\n    </vdr-ab-right>\n  </vdr-action-bar>\n\n  <clr-modal [(clrModalOpen)]=\"showMessage\">\n    <h3 class=\"modal-title\">Add Webhook</h3>\n    <div class=\"modal-body\">\n      <div class=\"popupContainer\">\n        <div class=\"card\">\n          <div style=\"width: 100%\">\n            <ul class=\"list-group list-group-flush\">\n              <li class=\"list-group-item\">\n                <h4 class=\"card-title\">Request Transformer</h4>\n                <select\n                  clrSelect\n                  [(ngModel)]=\"requestTransformerName\"\n                  (ngModelChange)=\"requestTransformerSelected()\"\n                >\n                  <option value=\"{{ undefined }}\">--select---</option>\n                  <option\n                    *ngFor=\"\n                      let transformers of avaiabelWebhookRequestTransformers\n                    \"\n                    [value]=\"transformers.name\"\n                  >\n                    {{ transformers.name }}\n                  </option>\n                </select>\n              </li>\n              <li class=\"list-group-item\">\n                <h4 class=\"card-title\">Event *</h4>\n                <select clrSelect [(ngModel)]=\"eventName\">\n                  <option value=\"{{ undefined }}\">--select---</option>\n                  <option\n                    *ngFor=\"let event of filteredWeebhookEvents\"\n                    [value]=\"event\"\n                  >\n                    {{ event }}\n                  </option>\n                </select>\n              </li>\n              <li class=\"list-group-item\">\n                <h4 class=\"card-title\">URL *</h4>\n                <input\n                  clrInput\n                  placeholder=\"https://\"\n                  name=\"input\"\n                  [(ngModel)]=\"url\"\n                />\n              </li>\n            </ul>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div class=\"modal-footer\">\n      <button\n        type=\"button\"\n        class=\"btn btn-outline\"\n        (click)=\"showMessage = false\"\n      >\n        Cancel\n      </button>\n      <button class=\"btn btn-primary\" (click)=\"create()\">Submit</button>\n    </div>\n  </clr-modal>\n\n  <vdr-data-table\n    [items]=\"webhooks\"\n    [itemsPerPage]=\"itemsPerPage\"\n    [totalItems]=\"webhooks.length\"\n    [currentPage]=\"currentPage\"\n    (pageChange)=\"setPageNumber($event)\"\n    (itemsPerPageChange)=\"setItemsPerPage($event)\"\n  >\n    <vdr-dt-column>Event</vdr-dt-column>\n    <vdr-dt-column>Request Transformer</vdr-dt-column>\n    <vdr-dt-column>URL</vdr-dt-column>\n    <vdr-dt-column></vdr-dt-column>\n\n    <ng-template let-webhook=\"item\">\n      <td class=\"left align-middle\">\n        {{ webhook.event }}\n      </td>\n      <td class=\"left align-middle\">\n        {{ webhook.requestTransformer?.name }}\n      </td>\n      <td class=\"left align-middle\">\n        {{ webhook.url }}\n      </td>\n      <td>\n        <vdr-dropdown>\n          <button type=\"button\" class=\"btn btn-link btn-sm\" vdrDropdownTrigger>\n            {{ 'common.actions' | translate }}\n            <clr-icon shape=\"caret down\"></clr-icon>\n          </button>\n          <vdr-dropdown-menu vdrPosition=\"bottom-right\">\n            <button\n              type=\"button\"\n              class=\"delete-button\"\n              (click)=\"deleteWeebhook(webhook.id)\"\n              vdrDropdownItem\n            >\n              <clr-icon shape=\"trash\" class=\"is-danger\"></clr-icon>\n              {{ 'common.delete' | translate }}\n            </button>\n            <button\n              type=\"button\"\n              (click)=\"duplicate(webhook.requestTransformer?.name, webhook.url)\"\n              vdrDropdownItem\n            >\n              <clr-icon shape=\"copy\"></clr-icon>\n              Duplicate\n            </button>\n          </vdr-dropdown-menu>\n        </vdr-dropdown>\n      </td>\n    </ng-template>\n  </vdr-data-table>\n</vdr-page-block>\n","import { ChangeDetectorRef, Component, OnInit } from '@angular/core';\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport { DataService, NotificationService } from '@vendure/admin-ui/core';\nimport {\n  getAvailableWebhookEventsQuery,\n  getAvailableWebhookRequestTransformersQuery,\n  getWebhooksQuery,\n  setWebhooksMutation,\n} from './queries';\nimport {\n  Webhook,\n  WebhookInput,\n  WebhookRequestTransformer,\n} from './graphql-types';\n\n@Component({\n  selector: 'webhook-component',\n  templateUrl: './webhook.component.html',\n})\nexport class WebhookComponent implements OnInit {\n  webhooks: Webhook[] = [];\n  currentPage: number = 1;\n  itemsPerPage: number = 10;\n  eventName: string | undefined;\n  requestTransformerName: string | undefined;\n  url: string | undefined;\n  showMessage = false;\n  availableWeebhookEvents: string[] = [];\n  filteredWeebhookEvents: string[] = [];\n  avaiabelWebhookRequestTransformers: WebhookRequestTransformer[] = [];\n\n  constructor(\n    private formBuilder: FormBuilder,\n    protected dataService: DataService,\n    private changeDetector: ChangeDetectorRef,\n    private notificationService: NotificationService\n  ) {}\n\n  ngOnInit() {\n    this.dataService\n      .query(getAvailableWebhookEventsQuery)\n      .single$.subscribe((e: any) => {\n        this.filteredWeebhookEvents = this.availableWeebhookEvents =\n          e.availableWebhookEvents;\n      });\n    this.dataService.query(getWebhooksQuery).single$.subscribe((s: any) => {\n      this.webhooks = s.webhooks;\n    });\n    this.dataService\n      .query(getAvailableWebhookRequestTransformersQuery)\n      .single$.toPromise()\n      .then((d: any) => {\n        this.avaiabelWebhookRequestTransformers =\n          d.availableWebhookRequestTransformers;\n      });\n  }\n\n  setPageNumber(event: number) {\n    this.currentPage = event;\n  }\n\n  setItemsPerPage(event: number) {\n    this.itemsPerPage = event;\n  }\n\n  showCreateModal() {\n    this.showMessage = true;\n    this.eventName = '';\n    this.requestTransformerName = '';\n    this.url = '';\n    this.changeDetector.detectChanges();\n  }\n\n  create() {\n    if (\n      this.url &&\n      this.url !== '' &&\n      this.eventName &&\n      this.eventName !== ''\n    ) {\n      this.dataService\n        .mutate(setWebhooksMutation, {\n          webhooks: [\n            ...this.webhooks.map((w: Webhook) => {\n              return {\n                event: w.event,\n                transformerName: w.requestTransformer?.name,\n                url: w.url,\n              };\n            }),\n            {\n              event: this.eventName,\n              transformerName: this.requestTransformerName,\n              url: this.url,\n            },\n          ],\n        })\n        .subscribe((s: any) => {\n          this.showMessage = false;\n          this.notificationService.success('Webhook created successfully');\n          this.webhooks = s.setWebhooks;\n          this.changeDetector.detectChanges();\n        });\n    } else {\n      this.notificationService.error('Please enter all the required fields');\n    }\n  }\n\n  deleteWeebhook(id: number) {\n    this.webhooks = this.webhooks.filter((w: Webhook) => w.id != id);\n    this.changeDetector.detectChanges();\n    this.dataService\n      .mutate(setWebhooksMutation, {\n        webhooks: [\n          ...this.webhooks.map((w: Webhook) => {\n            return {\n              event: w.event,\n              transformerName: w.requestTransformer?.name,\n              url: w.url,\n            };\n          }),\n        ],\n      })\n      .subscribe((s: any) => {\n        this.webhooks = s.setWebhooks;\n        this.notificationService.success('Webhook deleted successfully');\n      });\n  }\n\n  requestTransformerSelected(setRequestTransformerName?: string) {\n    if (setRequestTransformerName) {\n      this.filteredWeebhookEvents =\n        this.avaiabelWebhookRequestTransformers.find(\n          (v) => v.name === this.requestTransformerName\n        )?.supportedEvents ?? [];\n    } else if (this.requestTransformerName) {\n      this.filteredWeebhookEvents =\n        this.avaiabelWebhookRequestTransformers.find(\n          (v) => v.name === this.requestTransformerName\n        )?.supportedEvents ?? [];\n    } else {\n      this.filteredWeebhookEvents = this.availableWeebhookEvents;\n    }\n    this.eventName = this.filteredWeebhookEvents.find(\n      (v) => v === this.eventName\n    );\n    this.changeDetector.detectChanges();\n  }\n\n  duplicate(requestTransformer: string, url: string) {\n    this.requestTransformerName = requestTransformer;\n    this.requestTransformerSelected(requestTransformer);\n    this.url = url;\n    this.showMessage = true;\n    this.changeDetector.detectChanges();\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { RouterModule } from '@angular/router';\nimport { addNavMenuItem, SharedModule } from '@vendure/admin-ui/core';\nimport { WebhookComponent } from './webhook.component';\n\n@NgModule({\n  imports: [\n    SharedModule,\n    RouterModule.forChild([\n      {\n        path: '',\n        pathMatch: 'full',\n        component: WebhookComponent,\n        data: { breadcrumb: 'Webhook' },\n      },\n    ]),\n  ],\n  providers: [\n    addNavMenuItem(\n      {\n        id: 'webhook',\n        label: 'Webhook',\n        routerLink: ['/extensions/webhook'],\n        icon: 'cursor-hand-open',\n      },\n      'settings'\n    ),\n  ],\n  declarations: [WebhookComponent],\n})\nexport class WebhookModule {}\n"],"x_google_ignoreList":[]}